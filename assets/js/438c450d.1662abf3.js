"use strict";(self.webpackChunkapp_docs=self.webpackChunkapp_docs||[]).push([[2360],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>d});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),h=l(n),d=a,b=h["".concat(c,".").concat(d)]||h[d]||u[d]||o;return n?r.createElement(b,s(s({ref:t},p),{},{components:n})):r.createElement(b,s({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=h;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,s[1]=i;for(var l=2;l<o;l++)s[l]=n[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},7373:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var r=n(7462),a=(n(7294),n(3905));const o={sidebar_position:8,description:"How to generate the JWT access token that gives access to a remote web service"},s="How a subscriber can integrate a web service",i={unversionedId:"tutorials/webservice-integration",id:"tutorials/webservice-integration",title:"How a subscriber can integrate a web service",description:"How to generate the JWT access token that gives access to a remote web service",source:"@site/docs/tutorials/08-webservice-integration.md",sourceDirName:"tutorials",slug:"/tutorials/webservice-integration",permalink:"/docs/tutorials/webservice-integration",draft:!1,editUrl:"https://github.com/nevermined-io/app_docs/tree/main/docs/tutorials/08-webservice-integration.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8,description:"How to generate the JWT access token that gives access to a remote web service"},sidebar:"tutorialSidebar",previous:{title:"Searching assets and buying subscriptions",permalink:"/docs/tutorials/search-and-purchase"},next:{title:"Getting tokens from faucets in testing environments",permalink:"/docs/tutorials/faucets"}},c={},l=[{value:"Getting ready",id:"getting-ready",level:2},{value:"How to integrate a web service",id:"how-to-integrate-a-web-service",level:2},{value:"1. Open your Dashboard page",id:"1-open-your-dashboard-page",level:3},{value:"2. Get the JWT access token",id:"2-get-the-jwt-access-token",level:3},{value:"3. Copy the JWT token",id:"3-copy-the-jwt-token",level:3},{value:"4. Use the JWT to call the service",id:"4-use-the-jwt-to-call-the-service",level:3},{value:"4.a Using curl to integrate the web service",id:"4a-using-curl-to-integrate-the-web-service",level:4},{value:"4.b Using typescript to integrate the web service",id:"4b-using-typescript-to-integrate-the-web-service",level:4}],p={toc:l};function u(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"how-a-subscriber-can-integrate-a-web-service"},"How a subscriber can integrate a web service"),(0,a.kt)("p",null,"In Nevermined you can find web services published by some other users. These web services are published in such a way any user can ",(0,a.kt)("a",{parentName:"p",href:"/docs/tutorials/search-and-purchase"},"purchase a subscription")," and get access to them."),(0,a.kt)("p",null,"In this tutorial we are gonna see how a user who already owns a subscription giving access to a web service, can integrate that web service in an application."),(0,a.kt)("h2",{id:"getting-ready"},"Getting ready"),(0,a.kt)("p",null,"Currently, the ",(0,a.kt)("a",{parentName:"p",href:"https://mumbai.nevermined.app/"},"Nevermined App")," is connected to the Polygon Mumbai test network. In order to interact with that network you need to:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Connect your Metamask to Polygon Mumbai (instructions ",(0,a.kt)("a",{parentName:"li",href:"/docs/tutorials/metamask"},"here"),")."),(0,a.kt)("li",{parentName:"ol"},"Get some MATIC tokens to pay for the gas fees on that network. To do that you can get some free MATIC using the Mumbai Faucet (more information ",(0,a.kt)("a",{parentName:"li",href:"/docs/tutorials/faucets"},"here"),")."),(0,a.kt)("li",{parentName:"ol"},"You should have own a subscription with a web service attached to it. If you don't please read the Tutorial ",(0,a.kt)("a",{parentName:"li",href:"/docs/tutorials/search-and-purchase"},"How to search and purchase assets")," first.")),(0,a.kt)("h2",{id:"how-to-integrate-a-web-service"},"How to integrate a web service"),(0,a.kt)("p",null,"The steps to integrate are the following:"),(0,a.kt)("h3",{id:"1-open-your-dashboard-page"},"1. Open your Dashboard page"),(0,a.kt)("p",null,'Click on the \u201cDashboard\u201d link on the header of the application. Click on the "Purchased" link to display the subscriptions you purchased and already own.'),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Consumer Dashboard",src:n(9613).Z,width:"2525",height:"1373"})),(0,a.kt)("h3",{id:"2-get-the-jwt-access-token"},"2. Get the JWT access token"),(0,a.kt)("p",null,"Now you can see all the subscriptions you own, if you click in the arrow you will expand the view listing all the assets (datasets and webservices) included as part of the subscription."),(0,a.kt)("p",null,'All the web services included as part of the subscription are identified with the type "Web service" and will show an ',(0,a.kt)("strong",{parentName:"p"},'"API"')," button at right. If you click on it, the application will require you to sign a message and will show the web service JWT access token."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Consumer Dashboard",src:n(7736).Z,width:"2525",height:"1373"})),(0,a.kt)("h3",{id:"3-copy-the-jwt-token"},"3. Copy the JWT token"),(0,a.kt)("p",null,"The JWT token is the access key identifying you as a subscriber and allows you to make HTTP requests to the web service. Once you have it, using it you can make requests to all the endpoints included as part of the web service."),(0,a.kt)("p",null,"Copy the JWT token and the Proxy url (",(0,a.kt)("a",{parentName:"p",href:"https://proxy.nevermined.network/"},"https://proxy.nevermined.network/"),") from the screen, we are gonna use them to send a HTTP request."),(0,a.kt)("h3",{id:"4-use-the-jwt-to-call-the-service"},"4. Use the JWT to call the service"),(0,a.kt)("p",null,"Having the JWT and the Proxy url We are gonna test everything works in the command line. "),(0,a.kt)("h4",{id:"4a-using-curl-to-integrate-the-web-service"},"4.a Using curl to integrate the web service"),(0,a.kt)("p",null,"Here we are gonna use ",(0,a.kt)("strong",{parentName:"p"},"curl")," but the same works for any HTTP client application or library."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'# Here we export the JWT token pasted from the NVM App\nexport $JWT_TOKEN=\u201d\u201d\n\n# In our example we are sending a body message via HTTP POST. \n# For sake of clarity, here we export the message we are gonna send to the web service\nexport REQUEST_DATA=\'{"queries": [{"query": "Adam And Evil", "filter": {}, "top_k": 1 }]}\'\n\n# With curl we make a POST request and we add the $JWT_TOKEN as Bearer token in the Authorization header\n# The url where we send the request is the host name of the proxy: "https://proxy.nevermined.network" plus the endpoint of the service \n# we are calling, int this case "/ask"\ncurl -k -X POST -H "Content-Type: application/json"  -H "Authorization: Bearer $JWT_TOKEN" -d "$REQUEST_DATA" https://proxy.nevermined.network/ask\n\n{"response":"\\nThe song is about a person who is in love with someone who is not perfect, but they cannot live without them. Despite knowing that loving this person will bring heartache, they are willing to take the risk and accept the consequences. The song also compares the relationship to the story of Adam and Eve, with the person in the song being like Adam and their love interest being like Eve.","source_nodes":[{"node":{"text":"...","doc_id":"8e748293-f8d2-41b8-a225-7479455b1899","embedding":null,"doc_hash":"451d68b33de1e8034e48c6a98865364e52edd02837f06c34c662ba6d6d462c76","extra_info":null,"node_info":{"start":0,"end":1030},"relationships":{"1":"did:nv:3e0a13a6dba0ab20e83bf25c3e820af8b71c94cea0ab0763b4f822a6998009e6"}},"score":0.7585169416635178}],"extra_info":null}\n')),(0,a.kt)("h4",{id:"4b-using-typescript-to-integrate-the-web-service"},"4.b Using typescript to integrate the web service"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'const proxyEndpoint = `https://proxy.nevermined.network/ask`\nconst requestData = \'{"queries": [{"query": "Adam And Evil", "filter": {}, "top_k": 1 }]}\'\n\nopts.headers = {\n    // The proxy expects the `HTTP Authorization` header with the JWT\n    authorization: `Bearer ${JWT_TOKEN}`,\n    \'content-type\': \'application/json\'\n}\n\nopts.method = \'POST\'\nopts.body = requestData\n\nconst result = await fetch(proxyEndpoint, opts)\n\nassert.isTrue(result.ok)\nassert.equal(result.status, 200)\n')))}u.isMDXComponent=!0},9613:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/15_Consumer_Dashboard_after-f344a1cf239bfb672b1df13e19d5c617.png"},7736:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/16_Consumer_Dashboard_JWT-3e977a0fadaab18aac5578ba998f9a42.png"}}]);