<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/ai/huggingface" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">How to create and integrate a Hugging Face Inference Endpoint | Nevermined Payments Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.nevermined.app/docs/tutorials/ai/huggingface"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How to create and integrate a Hugging Face Inference Endpoint | Nevermined Payments Documentation"><meta data-rh="true" name="description" content="How to create and integrate a Hugging Face Inference Endpoint"><meta data-rh="true" property="og:description" content="How to create and integrate a Hugging Face Inference Endpoint"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.nevermined.app/docs/tutorials/ai/huggingface"><link data-rh="true" rel="alternate" href="https://docs.nevermined.app/docs/tutorials/ai/huggingface" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.nevermined.app/docs/tutorials/ai/huggingface" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://E8X6MW6KMN-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Nevermined Payments Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Nevermined Payments Documentation Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XJGFKP2VS4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XJGFKP2VS4",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Nevermined Payments Documentation" href="/opensearch.xml">

<link rel="stylesheet" href="/lib/nvm-one-widget.css"><link rel="stylesheet" href="/assets/css/styles.dc181e17.css">
<script src="/assets/js/runtime~main.d7de11cf.js" defer="defer"></script>
<script src="/assets/js/main.53e6d87d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/nevermined/nevermined-app-logo.svg" alt="Nevermined Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/nevermined/nevermined-app-logo.svg" alt="Nevermined Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/docs/getting-started">Getting Started</a><a class="navbar__item navbar__link" href="/docs/libraries">Libraries</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/tutorials">Tutorials</a><a href="https://nevermined.app/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">App<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://docs.nevermined.io/docs/protocol" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Protocol<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://discord.gg/GZju2qScKq" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><img src="/nevermined/discord-gray.svg" alt="Discord" class="discord"></a><a href="https://github.com/nevermined-io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><img src="/nevermined/github-gray.svg" alt="Github" class="github"></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/getting-started/">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/libraries/">Libraries</a><button aria-label="Expand sidebar category &#x27;Libraries&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/tutorials/">Tutorials</a><button aria-label="Collapse sidebar category &#x27;Tutorials&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/tutorials/first-steps/">First Steps</a><button aria-label="Expand sidebar category &#x27;First Steps&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/tutorials/builders/">For AI Builders</a><button aria-label="Expand sidebar category &#x27;For AI Builders&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/tutorials/subscribers/">Subscribers</a><button aria-label="Expand sidebar category &#x27;Subscribers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/tutorials/integration/">Integration</a><button aria-label="Expand sidebar category &#x27;Integration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/tutorials/advanced/">Advanced Tutorials</a><button aria-label="Expand sidebar category &#x27;Advanced Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/tutorials/web3/">For Web3 users</a><button aria-label="Expand sidebar category &#x27;For Web3 users&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/tutorials/ai/">Where to deploy your AI and get paid</a><button aria-label="Collapse sidebar category &#x27;Where to deploy your AI and get paid&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/ai/streamlit">How to accept payments in your Streamlit application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/ai/super-agent">How to accept payments in your Super Agent AI application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/ai/expose-python-agent">How to expose a Python AI agent and publish it into Nevermined</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/ai/chatgpt-plugin">Monetizing a ChatGPT plugin using Nevermined</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tutorials/ai/huggingface">How to create and integrate a Hugging Face Inference Endpoint</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/environments/">Environments</a><button aria-label="Expand sidebar category &#x27;Environments&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/architecture/">Architecture</a><button aria-label="Expand sidebar category &#x27;Architecture&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/tutorials/"><span itemprop="name">Tutorials</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/tutorials/ai/"><span itemprop="name">Where to deploy your AI and get paid</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How to create and integrate a Hugging Face Inference Endpoint</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>How to create and integrate a Hugging Face Inference Endpoint</h1></header>
<p>Hugging Face is one of the most, if not the most important Open Source Communities, in the scope of Machine Learning and AI technologies.</p>
<p>It is not only a huge hub of models, datasets, and transformers, but also an environment where users can deploy, test, and productize AI models or pipelines.</p>
<p>Hugging Face allows users to implement and deploy models, transformers, pipelines, etc, in two different ways:</p>
<ul>
<li><a href="https://huggingface.co/docs/hub/spaces" target="_blank" rel="noopener noreferrer">Spaces</a> Based on Github repos, users can implement their models here and deploy it as an app for free (it&#x27;s also possible to pay for additional resources). This kind of deployment is for demo/fast development purposes, so it is not ready for production.</li>
<li><a href="https://huggingface.co/docs/inference-endpoints/index" target="_blank" rel="noopener noreferrer">Inference Endpoints</a>. With Inference Endpoints a user or organization is able to deploy a model into production in a cloud provider in a completely transparent way. Hugging Face will take care of deploying the necessary containers, securitization, auto scaling, etc</li>
</ul>
<p>In this tutorial we will show you how to deploy your models and pipelines as Inference Endpoints, and how to publish them in Nevermined App, so you can safely share and monetize your AI model.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="requirements">Requirements<a href="#requirements" class="hash-link" aria-label="Direct link to Requirements" title="Direct link to Requirements">​</a></h2>
<ul>
<li>A Hugging Face <a href="https://huggingface.co/join" target="_blank" rel="noopener noreferrer">Account</a></li>
<li><a href="https://huggingface.co/settings/billing" target="_blank" rel="noopener noreferrer">Payment Method added</a>. Inference Endpoints are not for free. We will show you how to keep the cost pretty low so you can test it without spending too much money.</li>
<li><a href="https://huggingface.co/docs/hub/security-tokens#how-to-manage-user-access-tokens" target="_blank" rel="noopener noreferrer">Generate a token</a> for your account with Read permissions.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-a-hugging-face-model">Deploy a Hugging Face model<a href="#deploy-a-hugging-face-model" class="hash-link" aria-label="Direct link to Deploy a Hugging Face model" title="Direct link to Deploy a Hugging Face model">​</a></h2>
<p>You can deploy any model available in Hugging Face Hub in a really straightforward way. This <a href="https://huggingface.co/docs/inference-endpoints/guides/create_endpoint" target="_blank" rel="noopener noreferrer">document</a> from Hugging Face&#x27;s documentation shows how to deploy a model from a repository.</p>
<p>In this tutorial we want to show you how to implement and deploy a more complex scenario, where you are not deploying an already built model, but a more elaborated process.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implement-and-deploy-your-own-ai-model">Implement and deploy your own AI Model<a href="#implement-and-deploy-your-own-ai-model" class="hash-link" aria-label="Direct link to Implement and deploy your own AI Model" title="Direct link to Implement and deploy your own AI Model">​</a></h2>
<p>Through the next sections you will learn how to implement a custom AI model or process, deploy it as Inference Endpoint and publish it in Nevermined App.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-new-model-repository">Create a new Model repository<a href="#create-a-new-model-repository" class="hash-link" aria-label="Direct link to Create a new Model repository" title="Direct link to Create a new Model repository">​</a></h3>
<p>In order to implement a custom model you have to create a new model repository. You can work locally in your implementation and use git to create and synchronize in Hugging Face, as it&#x27;s explained in <a href="https://huggingface.co/docs/inference-endpoints/guides/custom_handler" target="_blank" rel="noopener noreferrer">Hugging Face Documentation</a>. In this document you will find different examples of custom models.</p>
<p>Also you can manually create this model repository and add/edit the files using the UI. For the sake of simplicity we are doing this in this tutorial.</p>
<p>To create this repository you just need to use the button <em>New</em> you can find in the main page of your Huggin Face profile (or your organization profile)</p>
<p><img decoding="async" loading="lazy" alt="Create a new Model option" src="/assets/images/11-01-create-model-a77898bc83dc8c246841a3fb1d827960.png" width="941" height="300" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Create a new Model formulary" src="/assets/images/11-02-create-form-85857d390339f4065c4e088469db4621.png" width="1096" height="811" class="img_ev3q"></p>
<p>Once the model repository is created you can use the <em>Add</em> button to create and commit new files in the repository. Also you have the possibility to edit the files as many times as you need.</p>
<p><img decoding="async" loading="lazy" alt="Create a new Model files" src="/assets/images/11-03-Files-534b42fb523eb99f075acd6b273e0941.png" width="1143" height="519" class="img_ev3q">
<img decoding="async" loading="lazy" alt="Create a new Model add files" src="/assets/images/11-04-add-files-ae0b67c5532418fc15f3b82cfadede2b.png" width="1052" height="230" class="img_ev3q"></p>
<p>You will typically need a handler.py and a requirements.txt file.</p>
<p>Of course creating and editing the files directly in the repo is not the best way to implement your custom model because there is no way to test it before deploying the model as an Inference Point.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementing-a-simple-example-with-haystack">Implementing a simple example with Haystack<a href="#implementing-a-simple-example-with-haystack" class="hash-link" aria-label="Direct link to Implementing a simple example with Haystack" title="Direct link to Implementing a simple example with Haystack">​</a></h3>
<p>As we mentioned, in the Hugging Face documentation you can find multiple examples about how to expose your own model using custom Inference Endpoints. For our example we will take a different approach, to show you that there are more possibilities than &quot;just&quot; use a model.</p>
<p>In this case we are going to use <a href="https://haystack.deepset.ai" target="_blank" rel="noopener noreferrer">Haystack</a> to build a InMemory store where we will index a document related with DeSci DAOs, and using <a href="https://huggingface.co/deepset/roberta-base-squad2-distilled" target="_blank" rel="noopener noreferrer">roberta-base-squad2-distilled</a> we can implement a Q&amp;A service using the documents stored.</p>
<p>The fist step is to add the needed dependencies using the requirements.txt file:</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">farm-haystack==1.19.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">farm-haystack[inference]==1.19.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">validators==0.21.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Next we need to implement an EndpointHandler class in a handler.py file. This class will contain two methods, <strong>init</strong>, where we will place all the code that will be executed when the endpoint is starting (so it will executed only once), and <strong>call</strong>, that handles the execution calls.</p>
<p>In the <strong>init</strong> method we will place all the code to initialize Haystack and to read and index the file with the DeSci DAOs information. In the <strong>call</strong> method we read the payload of the call to get the question, and we call the Haystack pipeline to get an answer.</p>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> haystack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utils </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> fetch_archive_from_http</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> clean_wiki_text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> convert_files_to_docs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> haystack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Answer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> haystack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">document_stores </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> InMemoryDocumentStore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> haystack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipelines </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ExtractiveQAPipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> haystack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nodes </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> FARMReader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TfidfRetriever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> logging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;TOKENIZERS_PARALLELISM&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;false&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#Haystack Components</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">start_haystack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    document_store </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> InMemoryDocumentStore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    load_and_write_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">document_store</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    retriever </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TfidfRetriever</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">document_store</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">document_store</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> FARMReader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model_name_or_path</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;deepset/roberta-base-squad2-distilled&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> use_gpu</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pipeline </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ExtractiveQAPipeline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> retriever</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">load_and_write_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">document_store</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Get the absolute path of the script</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    script_path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">realpath</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__file__</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Get the script directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    script_dir </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dirname</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">script_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doc_dir </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> script_dir </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/dao_data&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Loading data ...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    docs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> convert_files_to_docs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dir_path</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">doc_dir</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> clean_func</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">clean_wiki_text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> split_paragraphs</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    document_store</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write_documents</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">docs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">EndpointHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> path</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># load the optimized model     </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipeline </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> start_haystack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__call__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inputs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;inputs&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        question </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;question&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> question </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            prediction </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">query</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">question</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;Retriever&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;top_k&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Reader&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;top_k&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># postprocess the prediction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;answer&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prediction</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;answers&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">answer</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And that&#x27;s it. We can now deploy this process as an Inference Endpoint. But remember, in a real scenario you should implement and test your model/process in your local environment to check that everything works correctly.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="expose-the-custom-model-as-inference-endpoint">Expose the custom Model as Inference Endpoint<a href="#expose-the-custom-model-as-inference-endpoint" class="hash-link" aria-label="Direct link to Expose the custom Model as Inference Endpoint" title="Direct link to Expose the custom Model as Inference Endpoint">​</a></h3>
<p>The next step is to publish your model as an Inference Endpoint. Remember, you need to add a Payment Method to be able to use this Hugging Face&#x27;s capability.</p>
<p>YOu can access to Inference Endpoints <a href="https://ui.endpoints.huggingface.co/" target="_blank" rel="noopener noreferrer">here</a>. In the main screen you can see the endpoints you have already deployed, and a <em>New endpoint</em> button to create a new one</p>
<p><img decoding="async" loading="lazy" alt="Inference Endpoints" src="/assets/images/11-05-endpoints-334930175eed4cd4819ef5416f5cb467.png" width="1235" height="410" class="img_ev3q"></p>
<p>In the New Endpoint formulary, you have to introduce the name of the repository where you have implemented your model. Also you need to choose the Cloud Provider (you can leave the default one).</p>
<p>You can pick a small Instance type, instead of the medium one, to keep the cost low (You can see the estimated cost per hour at the bottom of the screen). Take into account that this also implies that the execution time will be longer.</p>
<p><img decoding="async" loading="lazy" alt="Create new Inference Endpoint" src="/assets/images/11-06-new-endpoint-form-3e6caea1014d0f82250f985d1f4d0f06.png" width="910" height="957" class="img_ev3q"></p>
<p>In the <em>Advanced Configuration</em> section you can find some useful configuration. For instance you can enable the <em>Automatic Scale-to-Zero</em> option so the endpoint will be effectively paused where there is no activity (You can pause and resume your endpoint manually as well). The time the endpoint is paused won&#x27;t be billed.</p>
<p><img decoding="async" loading="lazy" alt="Advanced Configuration" src="/assets/images/11-07-advanced-config-228dc1abd38fd509b114cbe33ef37a8c.png" width="910" height="730" class="img_ev3q"></p>
<p>Once you finish to set all the configuration, click in the <em>Create Endpoint</em> button, and the Inference Endpoint will be initialized.
<img decoding="async" loading="lazy" alt="Inference Endpoint Initializing" src="/assets/images/11-08-initializing-ca70c090ecea0035f42eb3801132d43c.png" width="1226" height="582" class="img_ev3q"></p>
<p>After a few minutes you will see your Inference Endpoint running and the screen will show you the URL where it is located.</p>
<p><img decoding="async" loading="lazy" alt="Inference Endpoint Created" src="/assets/images/11-09-endpoint-created-5d3756404984323b407779e1bf39ec82.png" width="1191" height="569" class="img_ev3q"></p>
<p>In the <em>Settings</em> menu you can change the configuration of the Inference Endpoint, or update it to the latest version in your repository.</p>
<p><img decoding="async" loading="lazy" alt="Inference Endpoint Settings" src="/assets/images/11-10-endpoint-settings-0440252e8be6ef4cd4ae30ff8ccb5893.png" width="1224" height="779" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing-the-inference-endpoint">Testing the Inference Endpoint<a href="#testing-the-inference-endpoint" class="hash-link" aria-label="Direct link to Testing the Inference Endpoint" title="Direct link to Testing the Inference Endpoint">​</a></h3>
<p>To test the Inference Endpoint you just need the URL and your Read Token.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export HF_TOKEN=&quot;api_orgweRt....srbCQpQ&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl https://clmdl67ebofnkfxk.eu-west-1.aws.endpoints.huggingface.cloud \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-X POST \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-d &#x27;{&quot;inputs&quot;:{&quot;question&quot;:&quot;What is VitaDAO?&quot;}}&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-H &quot;Authorization: Bearer $HF_TOKEN&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-H &quot;Content-Type: application/json&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the execution of the endpoint takes around (or over) a minute, we will recommend you to change the settings of the Instance Type, for instance from <em>small</em> to <em>medium</em></p>
<p>If you have deployed the Inference endpoint under an organization, any user who belongs to the organization will be able to access to the endpoint using their own Read Tokens.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="publish-the-inference-endpoint-in-nevermined">Publish the Inference Endpoint in Nevermined<a href="#publish-the-inference-endpoint-in-nevermined" class="hash-link" aria-label="Direct link to Publish the Inference Endpoint in Nevermined" title="Direct link to Publish the Inference Endpoint in Nevermined">​</a></h2>
<p>Once you have implemented and deployed and protected your own AI model or pipeline in HuggingFace, you can share it with the Community in a safe way, and even monetize them, if you want, using a Nevermined Payment Plan.</p>
<p>In order to test and learn how you can use Nevermined App, we provide a testing environment where you can try the different features provided by Nevermined.</p>
<p>You can access to this test version of Nevermined App <a href="https://testing.nevermined.app/en" target="_blank" rel="noopener noreferrer">here</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="before-you-register-your-service">Before you register your Service<a href="#before-you-register-your-service" class="hash-link" aria-label="Direct link to Before you register your Service" title="Direct link to Before you register your Service">​</a></h3>
<p>We recommend you to take a look to the different <a href="/docs/getting-started/">guides and tutorials we have about Nevermined App</a></p>
<p>The next step is to create a brand new <a href="/docs/tutorials/builders/create-plan">Payment Plan</a></p>
<p>You will register your AI Service associated with this Subscription you are about to create. The process to create a new Subscription is pretty straightforward, but <a href="/docs/tutorials/builders/create-plan">here</a> you can find some help to guide you.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="registering-the-ai-model">Registering the AI Model<a href="#registering-the-ai-model" class="hash-link" aria-label="Direct link to Registering the AI Model" title="Direct link to Registering the AI Model">​</a></h3>
<p>So now that you have all set up and you have created a Payment Plan, you can create a Web Service Asset to register your AI Model in Nevermined App.</p>
<p>You can find a complete guide to register your service <a href="/docs/tutorials/builders/register-agent/">here</a></p>
<p>In the <em>details</em> step you need to add the endpoint. As the Inference Endpoint does not generate any OpenAPI document, we need to do it manually.</p>
<p>Add the Inference Endpoint URL as a <em>HTTP POST</em> Protected Method.</p>
<p>Select <em>Bearer Token</em> and add a Hugging Face Token with Read Permissions. This token will be sent and stored encrypted, so no one will be able to access it.</p>
<p>Make sure you provide enough information about your service in the <em>Description</em> and <em>Integration</em> fields to allow the user to understand the purpose of your service and how they can use it.</p>
<p><img decoding="async" loading="lazy" alt="Register service in Nevermined" src="/assets/images/11-11-creating-service-nvm-bb823bf62c2948dac647551d8f48840a.png" width="1087" height="734" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-to-the-details-of-the-service">Access to the details of the Service<a href="#access-to-the-details-of-the-service" class="hash-link" aria-label="Direct link to Access to the details of the Service" title="Direct link to Access to the details of the Service">​</a></h3>
<p>When the process is finished, you will be able to access the details of your new Service Asset (you can also access anytime using the &quot;MyAssets&quot; menu on the App).
In the Service details you can access the description of the endpoints.</p>
<p><img decoding="async" loading="lazy" alt="Service details in Nevermined" src="/assets/images/11-12-nvm-service-details-903df8ea90cbd9866d321cbdfd467021.png" width="1217" height="748" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="consuming-your-ai-model">Consuming your AI Model<a href="#consuming-your-ai-model" class="hash-link" aria-label="Direct link to Consuming your AI Model" title="Direct link to Consuming your AI Model">​</a></h3>
<p>Every user that have purchased your Subscription will be able to use your AI Model through Nevermined. In this <a href="/docs/tutorials/integration/agent-integration/">guide</a> you can find how users can integrate your service.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h4>
<p>Use the service through Nevermined Proxy URL is really straightforward, you need to use the Proxy URL instead of the actual URL of your service, adding the specific endpoint you want to call and the parameters defined in that endpoint, and indicate and the Authorization Header with the JWT.</p>
<p>For instance:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export NVM_TOKEN=&quot;eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..EW-BsszuYJLLuBylm6VPvw.zlGJQcCRjjG_m....srbCQpQ&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -H &quot;Authorization: $NVM_TOKEN&quot; -X POST &quot;https://3dqf53c6wn5sd5crq1n0bzh92cr09kaevh16io0pbefn57kbcj.proxy.testing.nevermined.app&quot;  \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;content-type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data &#x27;{&quot;inputs&quot;:{&quot;question&quot;:&quot;What is VitaDAO?&quot;}}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/tutorials/ai/chatgpt-plugin"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Monetizing a ChatGPT plugin using Nevermined</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/environments/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Environments</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a></li><li><a href="#deploy-a-hugging-face-model" class="table-of-contents__link toc-highlight">Deploy a Hugging Face model</a></li><li><a href="#implement-and-deploy-your-own-ai-model" class="table-of-contents__link toc-highlight">Implement and deploy your own AI Model</a><ul><li><a href="#create-a-new-model-repository" class="table-of-contents__link toc-highlight">Create a new Model repository</a></li><li><a href="#implementing-a-simple-example-with-haystack" class="table-of-contents__link toc-highlight">Implementing a simple example with Haystack</a></li><li><a href="#expose-the-custom-model-as-inference-endpoint" class="table-of-contents__link toc-highlight">Expose the custom Model as Inference Endpoint</a></li><li><a href="#testing-the-inference-endpoint" class="table-of-contents__link toc-highlight">Testing the Inference Endpoint</a></li></ul></li><li><a href="#publish-the-inference-endpoint-in-nevermined" class="table-of-contents__link toc-highlight">Publish the Inference Endpoint in Nevermined</a><ul><li><a href="#before-you-register-your-service" class="table-of-contents__link toc-highlight">Before you register your Service</a></li><li><a href="#registering-the-ai-model" class="table-of-contents__link toc-highlight">Registering the AI Model</a></li><li><a href="#access-to-the-details-of-the-service" class="table-of-contents__link toc-highlight">Access to the details of the Service</a></li><li><a href="#consuming-your-ai-model" class="table-of-contents__link toc-highlight">Consuming your AI Model</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/libraries">Libraries</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/faq">FAQ</a></li><li class="footer__item"><a href="https://docs.nevermined.io/docs/protocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Protocol<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Nevermined App</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://nevermined.app/" target="_blank" rel="noopener noreferrer" class="footer__link-item">App<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://testing.nevermined.app/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Testing<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://nevermined.io/nevermined-blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/nevermined-io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCaDKPgnEk4ekvQo2vO6FIBQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:info@nevermined.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Email<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><ul class="social-links">
                  <li>
                    <a href="https://discord.gg/GZju2qScKq" target="_blank" rel="noopener noreferrer">
                      <img src="/nevermined/discord.svg" alt="Discord" class="discord">
                    </a>
                  </li>
                  <li>
                    <a href="https://github.com/nevermined-io" target="_blank" rel="noopener noreferrer">
                      <img src="/nevermined/github.svg" alt="Github" class="github">
                    </a>
                  </li>
                  <li>
                    <a href="https://twitter.com/nevermined_io" target="_blank" rel="noopener noreferrer">
                      <img src="/nevermined/twitter.svg" alt="Twitter" class="twitter">
                    </a>
                  </li>
                  <li>
                    <a href="https://medium.com/nevermined-io" target="_blank" rel="noopener noreferrer">
                      <img src="/nevermined/medium.svg" alt="Medium" class="medium">
                    </a>
                  </li>
                </ul></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Nevermined AG.</div></div></div></footer></div>
</body>
</html>